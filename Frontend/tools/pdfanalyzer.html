<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF Forensic Analyzer - CyberShield</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(to bottom, #0a1628 0%, #0f1d33 50%, #1a1140 100%);
        }

        .glow-text {
            text-shadow: 0 0 20px rgba(34, 211, 238, 0.5);
        }

        .cyber-card {
            background: rgba(15, 29, 51, 0.6);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(34, 211, 238, 0.2);
        }

        .drop-zone {
            background: rgba(10, 22, 40, 0.8);
            border: 2px dashed rgba(34, 211, 238, 0.3);
            transition: all 0.3s ease;
        }

        .drop-zone:hover, .drop-zone.dragover {
            border-color: #22d3ee;
            background: rgba(10, 22, 40, 0.95);
            box-shadow: 0 0 30px rgba(34, 211, 238, 0.2);
        }

        .badge {
            background: rgba(34, 211, 238, 0.1);
            border: 1px solid rgba(34, 211, 238, 0.3);
            color: #22d3ee;
        }

        .stat-card {
            background: rgba(10, 22, 40, 0.6);
            border: 1px solid rgba(34, 211, 238, 0.2);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            border-color: rgba(34, 211, 238, 0.5);
            transform: translateY(-2px);
        }

        .keyword-tag {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid rgba(239, 68, 68, 0.4);
            color: #fca5a5;
            padding: 4px 10px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            font-weight: 600;
        }

        .custom-scrollbar::-webkit-scrollbar {
            width: 8px;
        }

        .custom-scrollbar::-webkit-scrollbar-track {
            background: rgba(10, 22, 40, 0.5);
            border-radius: 4px;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: rgba(34, 211, 238, 0.3);
            border-radius: 4px;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: rgba(34, 211, 238, 0.5);
        }

        .analysis-section {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .pulse-glow {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }

        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: .7;
            }
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

    <!-- Main Container -->
    <div class="max-w-5xl w-full">
        
        <!-- Header Section -->
        <div class="text-center mb-8">
            <div class="inline-block mb-4">
                <span class="badge px-4 py-2 rounded-full text-sm font-semibold">
                    üõ°Ô∏è ENTERPRISE-GRADE SECURITY
                </span>
            </div>
            <h1 class="text-5xl font-bold text-white glow-text mb-4">
                Static PDF Forensics
            </h1>
            <p class="text-xl text-gray-300">
                Analyze PDF structure for malicious scripts and hidden links without opening the file
            </p>
        </div>

        <!-- Main Card -->
        <div class="cyber-card rounded-2xl shadow-2xl overflow-hidden">
            
            <!-- Upload Section -->
            <div class="p-8">
                <div id="dropZone" class="drop-zone rounded-xl p-12 text-center cursor-pointer">
                    <input type="file" id="fileInput" accept=".pdf" class="hidden">
                    <div class="text-gray-300">
                        <svg class="w-20 h-20 mx-auto mb-4 text-cyan-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                        </svg>
                        <p class="text-2xl font-semibold text-white mb-2">Click to Upload PDF</p>
                        <p class="text-gray-400">or drag and drop file here</p>
                    </div>
                </div>

                <!-- Analysis Report (Hidden by default) -->
                <div id="reportSection" class="hidden mt-8 space-y-6 analysis-section">
                    
                    <!-- Verdict Banner -->
                    <div id="verdictBanner" class="p-6 rounded-xl border-2">
                        <div class="flex items-center justify-between">
                            <div class="flex-1">
                                <h2 class="text-2xl font-bold mb-2" id="verdictTitle">Analysis Complete</h2>
                                <p class="text-base opacity-90" id="verdictText">Scanning file structure...</p>
                            </div>
                            <div class="text-right">
                                <div class="text-sm opacity-75 mb-1">Risk Score</div>
                                <div class="text-5xl font-bold" id="riskScore">0/10</div>
                            </div>
                        </div>
                    </div>

                    <!-- Grid Layout -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        
                        <!-- Metadata Card -->
                        <div class="stat-card p-6 rounded-xl">
                            <h3 class="text-cyan-400 font-bold text-lg mb-4 flex items-center">
                                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                                File Metadata
                            </h3>
                            <div id="metadataList" class="space-y-3 text-sm">
                                <!-- Metadata injected here -->
                            </div>
                        </div>

                        <!-- Suspicious Tags Card -->
                        <div class="stat-card p-6 rounded-xl">
                            <h3 class="text-red-400 font-bold text-lg mb-4 flex items-center">
                                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                                </svg>
                                Suspicious Elements
                            </h3>
                            <div id="suspiciousList" class="space-y-3 text-sm">
                                <!-- Tags injected here -->
                            </div>
                        </div>
                    </div>

                    <!-- Extracted URIs -->
                    <div class="stat-card p-6 rounded-xl">
                        <h3 class="text-yellow-400 font-bold text-lg mb-4 flex items-center">
                            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"></path>
                            </svg>
                            Extracted Links (URIs)
                        </h3>
                        <div id="uriList" class="text-sm text-gray-400 break-all max-h-48 overflow-y-auto custom-scrollbar">
                            <!-- Links injected here -->
                        </div>
                    </div>

                </div>
            </div>
        </div>

        <!-- Stats Footer -->
        <div class="grid grid-cols-3 gap-4 mt-8">
            <div class="stat-card rounded-xl p-6 text-center">
                <div class="text-4xl font-bold text-cyan-400 mb-2">99.9%</div>
                <div class="text-gray-400 text-sm font-medium">Detection Rate</div>
            </div>
            <div class="stat-card rounded-xl p-6 text-center">
                <div class="text-4xl font-bold text-cyan-400 mb-2">Static</div>
                <div class="text-gray-400 text-sm font-medium">Analysis</div>
            </div>
            <div class="stat-card rounded-xl p-6 text-center">
                <div class="text-4xl font-bold text-cyan-400 mb-2">24/7</div>
                <div class="text-gray-400 text-sm font-medium">Protection</div>
            </div>
        </div>
    </div>

    <script>
        const dropZone = document.getElementById('dropZone');
        const fileInput = document.getElementById('fileInput');
        const reportSection = document.getElementById('reportSection');
        const verdictBanner = document.getElementById('verdictBanner');
        const verdictTitle = document.getElementById('verdictTitle');
        const verdictText = document.getElementById('verdictText');
        const riskScore = document.getElementById('riskScore');
        const metadataList = document.getElementById('metadataList');
        const suspiciousList = document.getElementById('suspiciousList');
        const uriList = document.getElementById('uriList');

        // Click to upload
        dropZone.addEventListener('click', () => fileInput.click());

        // Drag and drop handlers
        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.classList.add('dragover');
        });

        dropZone.addEventListener('dragleave', () => {
            dropZone.classList.remove('dragover');
        });

        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.classList.remove('dragover');
            const file = e.dataTransfer.files[0];
            if (file && file.type === 'application/pdf') {
                handleFile(file);
            }
        });

        fileInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                handleFile(file);
            }
        });

        async function handleFile(file) {
            // Show report section
            reportSection.classList.remove('hidden');

            // Read file as ArrayBuffer
            const arrayBuffer = await file.arrayBuffer();
            const uint8Array = new Uint8Array(arrayBuffer);
            const text = new TextDecoder().decode(uint8Array);

            // Analyze PDF
            const analysis = analyzePDF(text, file);
            displayResults(analysis, file);
        }

        function analyzePDF(content, file) {
            const suspiciousKeywords = [
                '/JavaScript', '/JS', '/OpenAction', '/Launch', 
                '/SubmitForm', '/ImportData', '/AA', '/Names'
            ];

            const foundKeywords = [];
            suspiciousKeywords.forEach(keyword => {
                const regex = new RegExp(keyword, 'gi');
                const matches = content.match(regex);
                if (matches) {
                    foundKeywords.push({ keyword, count: matches.length });
                }
            });

            // Extract URIs
            const uriRegex = /\/URI\s*\(([^)]+)\)/gi;
            const uris = [];
            let match;
            while ((match = uriRegex.exec(content)) !== null) {
                uris.push(match[1]);
            }

            // Calculate risk score
            let risk = 0;
            foundKeywords.forEach(item => {
                if (['/JavaScript', '/JS'].includes(item.keyword)) risk += 3;
                else if (['/OpenAction', '/AA'].includes(item.keyword)) risk += 2;
                else risk += 1;
            });

            return {
                fileName: file.name,
                fileSize: (file.size / 1024).toFixed(2) + ' KB',
                suspiciousElements: foundKeywords,
                uris: uris,
                riskScore: Math.min(risk, 10)
            };
        }

        function displayResults(analysis, file) {
            // Set risk score and verdict
            riskScore.textContent = `${analysis.riskScore}/10`;

            if (analysis.riskScore >= 5) {
                verdictBanner.style.background = 'rgba(127, 29, 29, 0.4)';
                verdictBanner.style.borderColor = 'rgba(239, 68, 68, 0.5)';
                verdictTitle.style.color = '#fca5a5';
                verdictTitle.textContent = 'Suspicious / Malicious';
                verdictText.textContent = 'Found high-risk tags that can execute code.';
                verdictText.style.color = '#fca5a5';
                riskScore.style.color = '#fca5a5';
            } else if (analysis.riskScore > 0) {
                verdictBanner.style.background = 'rgba(180, 83, 9, 0.4)';
                verdictBanner.style.borderColor = 'rgba(251, 191, 36, 0.5)';
                verdictTitle.style.color = '#fcd34d';
                verdictTitle.textContent = 'Potentially Suspicious';
                verdictText.textContent = 'Some suspicious elements detected. Review carefully.';
                verdictText.style.color = '#fcd34d';
                riskScore.style.color = '#fcd34d';
            } else {
                verdictBanner.style.background = 'rgba(6, 78, 59, 0.4)';
                verdictBanner.style.borderColor = 'rgba(34, 197, 94, 0.5)';
                verdictTitle.style.color = '#6ee7b7';
                verdictTitle.textContent = 'Clean / Safe';
                verdictText.textContent = 'No suspicious elements detected in the PDF.';
                verdictText.style.color = '#6ee7b7';
                riskScore.style.color = '#6ee7b7';
            }

            // Display metadata
            metadataList.innerHTML = `
                <div class="flex justify-between py-2 border-b border-gray-700">
                    <span class="text-gray-400">File Name:</span>
                    <span class="text-white font-medium">${analysis.fileName}</span>
                </div>
                <div class="flex justify-between py-2 border-b border-gray-700">
                    <span class="text-gray-400">Size:</span>
                    <span class="text-white font-medium">${analysis.fileSize}</span>
                </div>
                <div class="flex justify-between py-2 border-b border-gray-700">
                    <span class="text-gray-400">Type:</span>
                    <span class="text-white font-medium">PDF Document</span>
                </div>
                <div class="flex justify-between py-2">
                    <span class="text-gray-400">Analysis Date:</span>
                    <span class="text-white font-medium">${new Date().toLocaleDateString()}</span>
                </div>
            `;

            // Display suspicious elements
            if (analysis.suspiciousElements.length > 0) {
                suspiciousList.innerHTML = analysis.suspiciousElements.map(item => `
                    <div class="flex items-center justify-between py-2 border-b border-gray-700 last:border-0">
                        <div class="flex items-center gap-3">
                            <span class="keyword-tag">${item.keyword}</span>
                            <span class="text-gray-400 text-xs">
                                ${item.keyword === '/JavaScript' || item.keyword === '/JS' ? 'Embedded JavaScript code' : 
                                  item.keyword === '/OpenAction' ? 'Action triggers automatically on open' :
                                  item.keyword === '/AA' ? 'Additional actions defined' : 'Potentially suspicious tag'}
                            </span>
                        </div>
                        <span class="text-white font-bold">x${item.count}</span>
                    </div>
                `).join('');
            } else {
                suspiciousList.innerHTML = '<p class="text-green-400">No suspicious elements found</p>';
            }

            // Display URIs
            if (analysis.uris.length > 0) {
                uriList.innerHTML = analysis.uris.map(uri => `
                    <div class="p-3 bg-gray-900/50 rounded-lg mb-2 border border-gray-700">
                        <a href="${uri}" target="_blank" class="text-cyan-400 hover:text-cyan-300 break-all">${uri}</a>
                    </div>
                `).join('');
            } else {
                uriList.innerHTML = '<p class="text-gray-500">No links found in the PDF</p>';
            }
        }
    </script>
</body>
</html